
Теперь у нас есть хороший способ хранить и ссылаться на графические ресурсы. Следующая тема — создание ресурсов.

Создание графических ресурсов в Vulkan и DX12 — обременительное занятие. Вам нужно заполнять большие структуры, которые содержат другие большие структуры. Некоторые из этих структур также содержат указатели на массивы структур. Это позволяет выстрелить себе в ногу временными сроками жизни объектов.

Наиболее распространенным существующим решением этой проблемы является использование шаблона строителя для дескрипторов ресурсов: объект строителя содержит хорошее состояние по умолчанию для дескриптора. Он предлагает API для мутации самого себя, чтобы задать все поля, которые вы хотите изменить. Когда вы будете готовы, вы вызываете функцию сборки, чтобы получить окончательную структуру дескриптора. Это легко использовать, но кодогенерация, особенно в режиме отладки, далека от совершенства. В HypeHype мы часто используем режим отладки во время разработки, поэтому мы хотим, чтобы он был быстрым. 

Наше решение этой проблемы — использовать назначенные инициализаторы структур C++20 в сочетании с агрегатной инициализацией структур C++11. Эти две функции в сочетании позволяют нам устанавливать значения по умолчанию для каждой структуры тривиальным способом. 
