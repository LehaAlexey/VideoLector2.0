
Мы хотим как можно меньшего количества платформенно-специфичного кода. Это приводит к дизайну, в котором мы плотно оборачиваем существующие низкоуровневые API gfx. 

Работа над дизайном началась с перекрестных ссылок на документы Vulkan, Metal и WebGPU. Я уже был знаком со всеми этими API, что упростило работу и сделало ее менее подверженной ошибкам. 

При написании оболочки сначала нужно найти общий набор функций. Их часто легко оборачиват. Трудности возникают, когда в дизайне API есть различия. Необходимо проявлять осторожность, чтобы абстрагировать эти различия таким образом, чтобы обеспечить оптимальную производительность. Мы решили использовать Metal 2.0, потому что он ближе к Vulkan и WebGPU и предоставляет кучи размещения, буферы аргументов и ручные ограждения, что позволяет нам извлечь немного больше производительности из устройств Apple.
